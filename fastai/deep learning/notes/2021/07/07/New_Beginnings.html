<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>New Beginnings | Unprofessional Honesty</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="New Beginnings" />
<meta name="author" content="Eyad Mohamed Ali" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This post covers part of the first 2.5 lessons of fastai’s Practical Deep Learning for Coders. My notes mainly focus on understanding the code supplied in the textbook. Here we understand what some of the beginning code does." />
<meta property="og:description" content="This post covers part of the first 2.5 lessons of fastai’s Practical Deep Learning for Coders. My notes mainly focus on understanding the code supplied in the textbook. Here we understand what some of the beginning code does." />
<link rel="canonical" href="https://prplhrt.github.io/Unprofessional-Honesty/fastai/deep%20learning/notes/2021/07/07/New_Beginnings.html" />
<meta property="og:url" content="https://prplhrt.github.io/Unprofessional-Honesty/fastai/deep%20learning/notes/2021/07/07/New_Beginnings.html" />
<meta property="og:site_name" content="Unprofessional Honesty" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-07-07T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"This post covers part of the first 2.5 lessons of fastai’s Practical Deep Learning for Coders. My notes mainly focus on understanding the code supplied in the textbook. Here we understand what some of the beginning code does.","url":"https://prplhrt.github.io/Unprofessional-Honesty/fastai/deep%20learning/notes/2021/07/07/New_Beginnings.html","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://prplhrt.github.io/Unprofessional-Honesty/fastai/deep%20learning/notes/2021/07/07/New_Beginnings.html"},"headline":"New Beginnings","dateModified":"2021-07-07T00:00:00-05:00","datePublished":"2021-07-07T00:00:00-05:00","author":{"@type":"Person","name":"Eyad Mohamed Ali"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/Unprofessional-Honesty/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://prplhrt.github.io/Unprofessional-Honesty/feed.xml" title="Unprofessional Honesty" /><link rel="shortcut icon" type="image/x-icon" href="/Unprofessional-Honesty/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/Unprofessional-Honesty/">Unprofessional Honesty</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/Unprofessional-Honesty/about/">About Me</a><a class="page-link" href="/Unprofessional-Honesty/search/">Search</a><a class="page-link" href="/Unprofessional-Honesty/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">New Beginnings</h1><p class="page-description">This post covers part of the first 2.5 lessons of fastai's Practical Deep Learning for Coders. My notes mainly focus on understanding the code supplied in the textbook. Here we understand what some of the beginning code does.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-07-07T00:00:00-05:00" itemprop="datePublished">
        Jul 7, 2021
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Eyad Mohamed Ali</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      4 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/Unprofessional-Honesty/categories/#fastai">fastai</a>
        &nbsp;
      
        <a class="category-tags-link" href="/Unprofessional-Honesty/categories/#deep learning">deep learning</a>
        &nbsp;
      
        <a class="category-tags-link" href="/Unprofessional-Honesty/categories/#notes">notes</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/PrplHrt/Unprofessional-Honesty/tree/master/_notebooks/2021-07-07-New_Beginnings.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/Unprofessional-Honesty/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/PrplHrt/Unprofessional-Honesty/master?filepath=_notebooks%2F2021-07-07-New_Beginnings.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/Unprofessional-Honesty/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/PrplHrt/Unprofessional-Honesty/blob/master/_notebooks/2021-07-07-New_Beginnings.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/Unprofessional-Honesty/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Let's-Begin">Let&#39;s Begin </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Cats-&-Dogs">Cats &amp; Dogs </a>
<ul>
<li class="toc-entry toc-h4"><a href="#ImageDataLoaders">ImageDataLoaders </a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#
</div>">&#39; %} </a>
<ul>
<li class="toc-entry toc-h4"><a href="#Convoluted-Neural-Networks-(CNNs)">Convoluted Neural Networks (CNNs) </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#
</div>">&#39; %} </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-07-07-New_Beginnings.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>Disclaimers:&gt; Firstly, I generally have little to no idea what I'm doing. For the most part, I'm trying to better myself with only a vague idea of where my next step will take me. The following notes are an attempt at building consistent, productive habits. I hope that these habits will help improve my abilities over time. To all who read this, I hope you enjoy it and maybe learn a thing or two.</p>
<p>Secondly, there might be some grammatical mistakes in the following post, that's to be expected since these notes were initially meant for my eyes only. Also, I might have made a few mistakes and, due to lack of understanding, copied the language used by the original source.</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Let's-Begin">
<a class="anchor" href="#Let's-Begin" aria-hidden="true"><span class="octicon octicon-link"></span></a>Let's Begin<a class="anchor-link" href="#Let's-Begin"> </a>
</h2>
<p><strong>Deep learning is the product of emulating how our brains work with artificial neurons. You can find a more accurate and detailed description in this <a href="https://colab.research.google.com/github/fastai/fastbook/blob/master/01_intro.ipynb">notebook</a> (thank you, fastai).</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Cats-&amp;-Dogs">
<a class="anchor" href="#Cats-&amp;-Dogs" aria-hidden="true"><span class="octicon octicon-link"></span></a>Cats &amp; Dogs<a class="anchor-link" href="#Cats-&amp;-Dogs"> </a>
</h3>
<p><em>The following notes cover the code featured in the jupyter notebooks featured in fastai's <a href="https://course.fast.ai/">Practical Deep Learning for Coders</a>.</em></p>
<p>This code is from the <a href="https://colab.research.google.com/github/fastai/fastbook/blob/master/01_intro.ipynb">first chapter</a> of the course.</p>

<pre><code>from fastai.vision.all import *
path = untar_data(URLs.PETS)/'images'

def is_cat(x): return x[0].isupper()
dls = ImageDataLoaders.from_name_func(
    path, get_image_files(path), valid_pct=0.2, seed=42,
    label_func=is_cat, item_tfms=Resize(224))

learn = cnn_learner(dls, resnet34, metrics=error_rate)
learn.fine_tune(1)</code></pre>
<p>This block of code, as a whole, creates a deep learning model that can differentiate between cats and dogs. By breaking it down, we can learn a little more about how to write our own code.</p>

<pre><code>from fastai.vision.all import *
path = untar_data(URLs.PETS)/'images'</code></pre>
<p>The above lines of code import all the needed code and  returns a path object with the location of the downloaded and extracted dataset, respectively. The rest of the code will be explored in the next sections.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="ImageDataLoaders">
<a class="anchor" href="#ImageDataLoaders" aria-hidden="true"><span class="octicon octicon-link"></span></a>ImageDataLoaders<a class="anchor-link" href="#ImageDataLoaders"> </a>
</h4>
<pre><code>dls = ImageDataLoaders.from_name_func(
          path, get_image_files(path), 
          valid_pct=0.2, seed=42,
          label_func=is_cat, 
          item_tfms=Resize(224)
      )</code></pre>
<p>The above code is where we tell fastai about the data we will be supplying. <code>dls</code> tells fastai what kind of dataset we have and how it's structured. <code>dls</code> is what we call a DataLoaders object, we'll get more into that in another post.</p>
<ul>
<li>
<a href="https://docs.fast.ai/vision.data.html#ImageDataLoaders"> <code>ImageDataLoaders</code></a> - one of the many classes for deeplearning (a type of DataLoaders), the first part shows the type of data we're going to be using (in this case Images).</li>
<li>
<code>.from_name_func</code> - this tells fastai to get the label of the data from a function applied to the file name.</li>
<li>
<code>path</code> - where the image files are located</li>
<li>
<code>get_image_files(path)</code> - returns a list of all the images in this path</li>
<li>
<code>valid_pct = 0.2, seed = 42</code> - tells fastai to use 20% of the images as a validation set and the seed (for generating pseudorandom numbers) is set to 42.</li>
<li>
<code>label_func = is_cat</code> - label_func takes in the function used to label the images. The function <code>is_cat</code> will be given the file names (thanks to the <code>from_name_func</code> part of the code) and then return the label.</li>
<li>
<code>item_tfms=Resize(224)</code> - <code>item_tfms</code> is the function applied to every item in the dataset. In this case, the fastai function <code>Resize(224)</code> is used to resize each image to a 224 x 224 pixel image. </li>
</ul>
<hr>
<p></p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>is_cat returns True (cat) if the first letter of the file name is in upper case and False (not cat) otherwise

</div>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>We can also have batch transforms which apply to groups of items at once. These can be done on GPUs to be done in parallel (pretty fast).&lt;/p&gt;
<h2 id="
&lt;/div&gt;">
<a class="anchor" href="#%0A&lt;/div&gt;" aria-hidden="true"><span class="octicon octicon-link"></span></a>' %}<a class="anchor-link" href="#'-%%7D"> </a>
</h2>
</div>
&lt;/div&gt;
&lt;/div&gt;
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Convoluted-Neural-Networks-(CNNs)">
<a class="anchor" href="#Convoluted-Neural-Networks-(CNNs)" aria-hidden="true"><span class="octicon octicon-link"></span></a>Convoluted Neural Networks (CNNs)<a class="anchor-link" href="#Convoluted-Neural-Networks-(CNNs)"> </a>
</h4>
<pre><code>learn = cnn_learner(dls, resnet34, metrics=error_rate)</code></pre>
<p>The above code tells fastai to create a Convoluted Neural Network (CNN) using the resnet34 architecture - 34 is the number of layers in the CNN.</p>
<p>The metrics are values that represent the performance of the CNN at the end of every epoch (when the network goes through the data once). The metrics are not to be confused with the loss of a neural network. Loss is a function that changes with any change in the parameters used in the network; meanwhile, metrics don't always change with a change in parameter. In this case, the metric used is <code>error_rate</code> which returns the percentage of validation items mislabeled by the CNN. An alternative metric is the <code>accuracy</code> which returns the percentage labeled correct (1 - <code>error_rate</code>).</p>
<p>The function, <code>cnn_learner</code>, also has a parameter called <code>pretrained</code> that defaults to <code>True</code>. This parameter tells fastai to use the weights of previously created models. This starts off with a pretty capable model with the last layer (or head) of the previous model replaced with random parameters. Now we only need to run the line <code>learn.fine_tune(1)</code> which modifies the network to meet our needs.</p>
<hr>
<p></p>
<div class="flash flash-success">
    <svg class="octicon octicon-checklist octicon octicon-checklist" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M2.5 1.75a.25.25 0 01.25-.25h8.5a.25.25 0 01.25.25v7.736a.75.75 0 101.5 0V1.75A1.75 1.75 0 0011.25 0h-8.5A1.75 1.75 0 001 1.75v11.5c0 .966.784 1.75 1.75 1.75h3.17a.75.75 0 000-1.5H2.75a.25.25 0 01-.25-.25V1.75zM4.75 4a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-4.5zM4 7.75A.75.75 0 014.75 7h2a.75.75 0 010 1.5h-2A.75.75 0 014 7.75zm11.774 3.537a.75.75 0 00-1.048-1.074L10.7 14.145 9.281 12.72a.75.75 0 00-1.062 1.058l1.943 1.95a.75.75 0 001.055.008l4.557-4.45z"></path></svg>
    <strong>Tip: </strong>Finetuning a model (also called transfer learning) reminds me of how some people often transfer their skills from one field to another. It might help to think of it that way.&lt;/p&gt;
<h2 id="
&lt;/div&gt;">
<a class="anchor" href="#%0A&lt;/div&gt;" aria-hidden="true"><span class="octicon octicon-link"></span></a>' %}<a class="anchor-link" href="#'-%%7D"> </a>
</h2>
</div>
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
 

</div>
</div></div>
</div>
</div></div>
</div>


  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="PrplHrt/Unprofessional-Honesty"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/Unprofessional-Honesty/fastai/deep%20learning/notes/2021/07/07/New_Beginnings.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/Unprofessional-Honesty/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/Unprofessional-Honesty/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/Unprofessional-Honesty/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>A highly personal series of posts that will hopefully last longer than a month. I hope to talk about things I&#39;ve learned and my progress as I transition into a professional.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/PrplHrt" title="PrplHrt"><svg class="svg-icon grey"><use xlink:href="/Unprofessional-Honesty/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
